rules:
  - id: raptor.secrets.hardcoded.api_key.regex
    message: Hard-coded secret or key literal detected; consider using a secret manager.
    languages: [python, javascript, java, go]
    severity: HIGH
    pattern-either:
      - pattern-regex: 'AKIA[0-9A-Z]{16}'
      - pattern-regex: 'sk_live_[0-9A-Za-z_-]{20,}'
      - pattern-regex: '-----BEGIN (?:PRIVATE|RSA PRIVATE) KEY-----'
    metadata:
      cwe: ["CWE-798"]
      asvs: ["V6.6"]

  - id: raptor.secrets.hardcoded.password
    message: Hard-coded password or secret detected; use environment variables or a secret manager.
    languages: [python, javascript, java, go]
    severity: HIGH
    patterns:
      - pattern-either:
          - pattern: $VAR = "..."
          - pattern: $VAR = '...'
      - metavariable-regex:
          metavariable: $VAR
          regex: (?i).*(?:PASSWORD|SECRET|KEY|TOKEN|API[_-]?KEY).*
    metadata:
      cwe: ["CWE-798", "CWE-256"]
      asvs: ["V6.6"]
